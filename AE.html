<!DOCTYPE html>
<html lang="no">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-95290P62GD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-95290P62GD');
</script>

  <meta charset="UTF-8" />
  <title>Alkoholenhetskalkulator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      max-width: 850px;
      margin: 20px auto;
      padding: 10px;
      background-color: #f9fafc;
      color: #333;
    }
    h1, h2 {
      margin: 20px 0 10px;
    }
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-bottom: 15px;
      table-layout: fixed;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      background-color: #fff;
    }
    th, td {
      padding: 10px 8px;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
      font-size: 0.95em;
      color: #333;
    }
    th {
      background-color: #4a90e2;
      color: white;
      font-weight: 600;
      border-bottom: 2px solid #357abd;
      user-select: none;
    }
    tbody tr:hover {
      background-color: #f0f7ff;
      cursor: pointer;
    }
    tr.aktiv {
      background-color: #e0e0e0  !important;
    }

    input[type="number"] {
      width: 70%;
      padding: 6px 8px;
      box-sizing: border-box;
      border: 1.5px solid #bbb;
      border-radius: 4px;
      font-size: 1em;
      text-align: center;
      transition: border-color 0.3s;
      background-color: white;
      color: #333;
    }
    input[type="number"]:focus {
      border-color: #4a90e2;
      outline: none;
      background-color: #f7fbff;
    }

    .prosent-wrapper {
      position: relative;
    }
    .prosent-wrapper input {
      padding-right: 20px;
      text-align: center;
      background-color: white;
      color: #333;
    }
    .prosent-wrapper::after {
      content: "%";
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      color: #888;
      pointer-events: none;
    }
    .antall {
      opacity: 0.4;
      transition: opacity 0.2s;
      text-align: center;
    }
    .antall.active {
      opacity: 1;
    }

    .grand-total {
      font-size: 1.1em;
      text-align: right;
      margin-top: 15px;
      font-weight: bold;
      color: #222;
    }

    .knapper {
      margin-top: 20px;
      text-align: right;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }
    button {
      padding: 6px 12px;
      font-size: 0.9em;
      cursor: pointer;
      border-radius: 5px;
      background-color: #4a90e2;
      color: white;
      border: none;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #357abd;
    }
    .fjern-knapp {
      background: none;
      border: none;
      color: red;
      font-size: 1.2em;
      cursor: pointer;
      float: right;
    }
    #egendefinertseksjon {
      display: none;
    }

    @media print {
      tr.aktiv {
        background-color: #e0e0e0  !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      .fjern-knapp, button, .knapper {
        display: none;
      }
      input[type="number"] {
        text-align: center !important;
      }
      th {
      background-color: #4a90e2;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      color: white;
      font-weight: 600;
      border-bottom: 2px solid #357abd;
      user-select: none;
  
    }

    /* Responsivt */
    @media (max-width: 600px) {
      body {
        padding: 5px;
      }
      table, th, td {
        font-size: 0.85em;
      }
      input[type="number"] {
        width: 100%;
      }
      .knapper {
        flex-direction: column;
        align-items: stretch;
      }
      .knapper button {
        width: 100%;
      }
      .grand-total {
        font-size: 1em;
      }
    }
  </style>
</head>
<body>

  <h1>Kalkulator for beregning av alkoholenheter</h1>

  <div id="kalkulator"></div>

  <div id="egendefinertseksjon"></div>

  <div class="knapper">
    <button onclick="visEgendefinert()">Legg til egendefinert</button>
  </div>

  <div class="grand-total">
    Totalt antall alkoholenheter: <span id="grandTotal">0</span> AE
  </div>

  <div class="knapper">
    <button onclick="resetKalkulator()">Tøm</button>
    <button onclick="window.print()">Utskrift</button>
  </div>

  <script>
    // Din eksisterende JavaScript-kode her uendret
    const drikkedata = {
      "Øl/cider": [
        { volum: 0.5, visning: "0,5 liter", prosent: 4.5 },
        { volum: 0.33, visning: "0,33 liter", prosent: 4.5 },
      ],
      "Vin": [
        { volum: 0.125, visning: "125 cl (glass)", prosent: 12 },
        { volum: 0.75, visning: "0,75 liter (flaske)", prosent: 12 },
        { volum: 3, visning: "3 liter", prosent: 12 },
      ],
      "Brennevin": [
        { volum: 0.04, visning: "4 cl (shot)", prosent: 40 },
        { volum: 0.5, visning: "0,5 liter", prosent: 40 },
        { volum: 0.7, visning: "0,7 liter", prosent: 40 },
      ]
    };

    const kalkulatorDiv = document.getElementById("kalkulator");
    const egendefinertSeksjon = document.getElementById("egendefinertseksjon");

    for (const kategori in drikkedata) {
      const h2 = document.createElement("h2");
      h2.textContent = kategori;
      kalkulatorDiv.appendChild(h2);

      const table = lagTabell(kategori, drikkedata[kategori]);
      kalkulatorDiv.appendChild(table);
    }

    let egendefinertH2;
    let egendefinertTable;

    function visEgendefinert() {
      egendefinertSeksjon.style.display = "block";
      if (!egendefinertTable) {
        egendefinertH2 = document.createElement("h2");
        egendefinertH2.textContent = "Egendefinert";
        egendefinertSeksjon.appendChild(egendefinertH2);

        egendefinertTable = lagTabell("Egendefinert", [], true);
        egendefinertSeksjon.appendChild(egendefinertTable);
      } else {
        leggTilEgendefinertRad();
      }
    }

    function lagTabell(kategori, rader, egendefinert = false) {
      const table = document.createElement("table");
      table.dataset.kategori = kategori;

      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Volum</th>
          <th>Alkoholprosent</th>
          <th>Antall</th>
          <th>Alkoholenheter</th>
        </tr>`;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      table.appendChild(tbody);

      if (!egendefinert) {
        rader.forEach(({ volum, visning, prosent }) => {
          const tr = document.createElement("tr");
          tr.dataset.volume = volum;
          tr.innerHTML = `
            <td>${visning}</td>
            <td><div class="prosent-wrapper"><input type="number" class="prosent" value="${prosent}" step="any"></div></td>
            <td><input type="number" class="antall" value="0" step="any"></td>
            <td class="ae"></td>`;
          tbody.appendChild(tr);
          leggTilLyttere(tr);
        });
      } else {
        leggTilEgendefinertRad(tbody);
      }

      return table;
    }

    function leggTilEgendefinertRad(tbody = null) {
      if (!tbody) {
        tbody = document.querySelector("table[data-kategori='Egendefinert'] tbody");
      }
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input type="number" class="volum" step="any" placeholder="Liter"></td>
        <td><div class="prosent-wrapper"><input type="number" class="prosent" step="any" placeholder="Alkoholprosent"></div></td>
        <td><input type="number" class="antall" value="0" step="any"></td>
        <td class="ae"><button class="fjern-knapp" onclick="fjernRad(this)">&times;</button></td>`;
      tbody.appendChild(tr);
      leggTilLyttere(tr);
    }

    function leggTilLyttere(tr) {
      const inputs = tr.querySelectorAll("input");
      inputs.forEach(input => {
        const initial = input.value;
        let touched = false;
        input.addEventListener("focus", () => {
          if (!touched && (input.value === initial || input.value === "0")) {
            input.value = "";
          }
        });
        input.addEventListener("input", () => {
          touched = true;
          oppdaterKalkulasjon();
        });
      });
    }

    document.querySelectorAll("tbody tr").forEach(leggTilLyttere);

    function kalkulerAE(volum, prosent, antall) {
      if (!volum || !prosent || !antall) return 0;
      return volum * prosent * antall * 8 / 12;

    }

    function oppdaterKalkulasjon() {
      let total = 0;
      document.querySelectorAll("tbody tr").forEach(tr => {
        const volumInput = tr.querySelector(".volum");
        const prosentInput = tr.querySelector(".prosent");
        const antallInput = tr.querySelector(".antall");
        const aeTd = tr.querySelector(".ae");

        const volum = volumInput ? parseFloat(volumInput.value) : parseFloat(tr.dataset.volume);
        const prosent = prosentInput ? parseFloat(prosentInput.value) : parseFloat(tr.querySelector(".prosent").value);
        const antall = antallInput ? parseFloat(antallInput.value) : parseFloat(tr.querySelector(".antall").value);

        const ae = kalkulerAE(volum, prosent, antall);
        aeTd.textContent = ae ? ae.toFixed(1) : "";

        if (antall > 0) {
          tr.classList.add("aktiv");
        } else {
          tr.classList.remove("aktiv");
        }
        total += ae;
      });
      document.getElementById("grandTotal").textContent = Math.round(total);
    }

    function resetKalkulator() {
      document.querySelectorAll("input[type=number]").forEach(input => {
        input.value = input.defaultValue || "0";
      });
      document.querySelectorAll("tr.aktiv").forEach(tr => tr.classList.remove("aktiv"));
      document.getElementById("grandTotal").textContent = "0";
      oppdaterKalkulasjon();
    }

    function fjernRad(knapp) {
      const tr = knapp.closest("tr");
      tr.remove();
      oppdaterKalkulasjon();
    }

    // Initial oppdatering ved innlasting
    oppdaterKalkulasjon();
  </script>
</body>
</html>
